# Mattermost Azure Kubernetes Configuration
# This is an example configuration file with placeholder passwords
# Run: make env (to create .env with secure generated passwords)

# Azure Configuration
RESOURCE_GROUP=mattermost-test-rg
CLUSTER_NAME=mattermost-test-aks
LOCATION=eastus2

# AKS Cluster Configuration
# Reference architecture for 2000 users: 2 nodes × F2s_v2 (2 vCPU, 4 GB RAM)
# Using Standard_D4s_v4 (4 vCPU, 16 GB RAM) for more headroom and system pods
NODE_COUNT=2
NODE_VM_SIZE=Standard_D4s_v4

# PostgreSQL Configuration
# Reference architecture for 2000 users: Writer + Reader (2 vCPU, 16 GB RAM each)
# Using Standard_E2ds_v4 (2 vCPU, 16 GB RAM) - PostgreSQL equivalent of E2as_v6 VM SKU
# Storage: 256 GB (supports 120-600 GB annual growth for 2000 users)
POSTGRES_SERVER=mattermost-postgres
POSTGRES_DB=mattermost
POSTGRES_ADMIN_USER=mmuser
POSTGRES_PASSWORD=CHANGE_ME_USE_GENERATE_SECRETS_SCRIPT
POSTGRES_TIER=MemoryOptimized
POSTGRES_SKU=Standard_E2ds_v4
POSTGRES_STORAGE_SIZE=256
POSTGRES_VERSION=18
POSTGRES_PUBLIC_ACCESS=0.0.0.0
POSTGRES_CREATE_REPLICA=true
POSTGRES_REPLICA_NAME=mattermost-postgres-replica

# MinIO Configuration
MINIO_OPERATOR_VERSION=v7.1.1
MINIO_IMAGE=cgr.dev/chainguard/minio:latest
MINIO_ADMIN_USER=admin
MINIO_ADMIN_PASSWORD=CHANGE_ME_USE_GENERATE_SECRETS_SCRIPT
MINIO_SERVICE_USER=mattermost
MINIO_SERVICE_PASSWORD=CHANGE_ME_USE_GENERATE_SECRETS_SCRIPT

# s3proxy Configuration (for deploy-s3proxy.sh)
S3PROXY_STORAGE_ACCOUNT=mattermosts3proxy          # Azure Storage Account name (must be globally unique, 3-24 chars, lowercase/numbers only)
S3PROXY_STORAGE_SKU=Standard_LRS                    # Storage SKU (Standard_LRS, Standard_GRS, Standard_ZRS, Premium_LRS)
S3PROXY_CONTAINER=mattermost                        # Azure Blob Storage container name
S3PROXY_ACCESS_KEY=mattermost                       # S3 access key for Mattermost to use
S3PROXY_SECRET_KEY=CHANGE_ME_USE_GENERATE_SECRETS_SCRIPT  # S3 secret key for Mattermost to use
S3PROXY_NAMESPACE=s3proxy                          # Kubernetes namespace for S3Proxy deployment
S3PROXY_IMAGE=andrewgaul/s3proxy:s3proxy-2.9.0     # S3Proxy Docker image
# cert-manager Configuration
CERT_MANAGER_VERSION=v1.19.2

# Gateway Configuration
DOMAIN=mattermost.example.com
EMAIL=admin@example.com
DNS_SERVER=8.8.8.8
ALB_FRONTEND_NAME=frontend-mattermost
ALB_ASSOCIATION_NAME=association-mattermost

# Mattermost Configuration
# Reference architecture for 2000 users: 2 replicas × (2 vCPU, 4 GB RAM)
MATTERMOST_VERSION=11.2.1
MATTERMOST_SIZE=2000users
MATTERMOST_REPLICAS=2
MM_SERVICEENVIRONMENT=production

# Mattermost S3 Storage Settings (for MinIO and s3proxy deployments)
# These settings control encryption and security for S3-compatible storage
MM_FILESETTINGS_AMAZONS3SSL=false        # Use HTTP for in-cluster communication (MinIO has no TLS configured)
MM_FILESETTINGS_AMAZONS3SSE=false        # Server-side encryption (true for MinIO, false for S3Proxy - not supported)
MM_FILESETTINGS_AMAZONS3TRACE=false      # Enable S3 debug logging (set to true for troubleshooting)

# NFS Storage Configuration (for deploy-nfs.sh)
# Reference architecture for 2000 users: 120-600 GB annual storage
NFS_STORAGE_SIZE=600Gi                   # Storage size for NFS PVC (supports 2000 users annual growth)
NFS_STORAGE_CLASS=azurefile-nfs-premium  # Azure Files Premium with NFS 4.1
NFS_PVC_NAME=mattermost-files            # Name of the PersistentVolumeClaim

# Mattermost License Configuration (REQUIRED)
# Path to your Mattermost license file
# This is REQUIRED - deployment will fail if not provided or file doesn't exist
LICENSE_FILE=./license.mattermost

# Notes:
# - Run 'make env' to create .env with secure 32-character passwords
# - Do NOT commit .env file to git (already in .gitignore)
# - Update DOMAIN with your actual domain name
# - Update EMAIL with your email for Let's Encrypt notifications
# - DNS_SERVER: DNS server for DNS verification checks (default: 8.8.8.8 Google DNS)
#   Alternatives: 1.1.1.1 (Cloudflare), 9.9.9.9 (Quad9), 208.67.222.222 (OpenDNS)
# - MM_SERVICEENVIRONMENT: Set to 'production', 'dev', or 'test' based on your license type
# - If using a test/dev license, set MM_SERVICEENVIRONMENT=test or MM_SERVICEENVIRONMENT=dev
